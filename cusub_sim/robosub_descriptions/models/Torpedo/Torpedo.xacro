<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro"
  name="Torpedo_robot">

  <xacro:include filename="$(find uuv_sensor_ros_plugins)/urdf/sensor_snippets.xacro"/>

  <xacro:macro name="torpedo_base" params="namespace">

  <link
    name="${namespace}/base_link">
    <inertial>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <mass
        value="44000.444" />
        <inertia
          ixx="0.00003"
          ixy="0.0"
          ixz="0.0"
          iyy="0.00003"
          iyz="0.0"
          izz="0.0" />
      </inertial>
    <visual>
      <origin
        xyz="0 0 -0.0629"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robosub_descriptions/models/Torpedo/Torpedo.stl" />
      </geometry>
    </visual>
    <collision>
      <origin
        xyz="0 0 -0.0629"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://robosub_descriptions/models/Torpedo/Torpedo.stl" />
      </geometry>
    </collision>
  </link>

  <xacro:default_pose_3d namespace="${namespace}" parent_link="${namespace}/base_link" />

  <gazebo>
    <plugin filename="libuuv_underwater_object_ros_plugin.so" name="uuv_plugin">
    <fluid_density>1028.0</fluid_density>
    <flow_velocity_topic>hydrodynamics/current_velocity</flow_velocity_topic>
    <debug>0</debug>
    <link name="${namespace}/base_link">
        <fluid_density>1028</fluid_density>
        <flow_velocity_topic>hydrodynamics/current_velocity</flow_velocity_topic>
        <neutrally_buoyant>0</neutrally_buoyant>
        <volume>42.0</volume>

        <box>
          <width>0.025</width>
          <length>0.117</length>
          <height>0.025</height>
        </box>

        <!-- Center of buoyancy -->
        <center_of_buoyancy>0 0 0</center_of_buoyancy>
        <hydrodynamic_model>

            <type>fossen</type>

            <added_mass>
              0    0    0    0     0    0
              0    0    0    0     0    0
              0    0    0    0     0    0
              0    0    0    0     0    0
              0    0    0    0     0    0
              0    0    0    0     0    0
            </added_mass>

            <linear_damping>
              -0.12 -0.12 -0.02 0 0 0
            </linear_damping>

        </hydrodynamic_model>
      </link>
    </plugin>
  </gazebo>

  </xacro:macro>

  <xacro:torpedo_base namespace="$(arg namespace)"/>

</robot>
